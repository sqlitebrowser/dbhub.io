[[ define "usagePage" ]]
<!doctype html>
<html ng-app="DBHub" ng-controller="prefView">
[[ template "head" . ]]
<body>
<script src="/js/plotly-basic-2.18.2.min.js"></script>
[[ template "header" . ]]
<div>
    <div class="row">
        <div class="col-md-3">
            &nbsp;
        </div>
        <div class="col-md-6">
            <h2 style="text-align: center;">Your usage</h2>

            <div id="visdisk" style="width:100%;"></div>

            <h3 style="text-align: center;">Number of standard databases over time</h3>
            <div id="visnumstd" style="width:100%;"></div>

            <h3 style="text-align: center;">Number of live databases over time</h3>
            <div id="visnumlive" style="width:100%;"></div>

            <!--

                What else would be useful to display here?

                * Probably most/all other stat info we collect

                  * API calls over time
                  * Database uploads/downloads over time
                  * What else?

             -->

        </div>
        <div class="col-md-3">
            &nbsp;
        </div>
    </div>
</div>
[[ template "footer" . ]]
<script>
    let plotDataDiskStd = {
        x: [[ .DiskDates ]],
        y: [[ .DiskStd ]],
        mode: 'lines',
        type: 'scatter',
        name: 'Standard databases'
    };

    let plotDataDiskLive = {
        x: [[ .DiskDates ]],
        y: [[ .DiskLive ]],
        mode: 'lines',
        type: 'scatter',
        name: 'Live databases'
    };
    let plotDataDisk = [plotDataDiskStd, plotDataDiskLive];
    let plotLayoutDisk = {
        title: 'Disk space used over time',
        showlegend: true,
        xaxis: {
            title: 'Date',
            showgrid: false,
            zeroline: false
        },
        yaxis: {
            title: 'Megabytes',
            showline: true
        }
    };
    let plotConfig = {
        displaylogo: false,
        editable: true,
        responsive: false, // Responsive mode badly screws things up in Firefox.  Better to handle resize events ourselves.
        watermark: false,
    };

    // * AngularJS *
    let app = angular.module('DBHub', ['ui.bootstrap', 'ngSanitize']);
    app.controller('prefView', function($scope, $http, $httpParamSerializerJQLike) {

        // Draw the charts
        Plotly.newPlot('visdisk', plotDataDisk, plotLayoutDisk);
    });
</script>
</body>
</html>
[[ end ]]
